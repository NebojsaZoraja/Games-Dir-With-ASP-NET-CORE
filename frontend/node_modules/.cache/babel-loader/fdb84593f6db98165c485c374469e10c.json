{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Neboj\\u0161a/Desktop/Games_Dir/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/Neboj\\u0161a/Desktop/Games_Dir/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/Neboj\\u0161a/Desktop/Games_Dir/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{Link}from\"react-router-dom\";import{Form,Button,Row,Col,Container,Card}from\"react-bootstrap\";import{useDispatch,useSelector}from\"react-redux\";import Message from\"../components/Message\";import Loader from\"../components/Loader\";import{getGameGenres,listGameDetails,updateGame}from\"../actions/gameActions\";import{GAME_GENRE_RESET,GAME_UPDATE_RESET}from\"../constatns/gameConstatns\";import axios from\"axios\";import Meta from\"../components/Meta\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var GameEditScreen=function GameEditScreen(_ref){var match=_ref.match,history=_ref.history;var gameId=match.params.id;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),title=_useState2[0],setTitle=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),price=_useState4[0],setPrice=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),image=_useState6[0],setImage=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),genre=_useState8[0],setGenre=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),publisher=_useState10[0],setPublisher=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),numberInStock=_useState12[0],setNumberInStock=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),description=_useState14[0],setDescription=_useState14[1];var _useState15=useState(\"\"),_useState16=_slicedToArray(_useState15,2),minRequirements=_useState16[0],setMinRequirements=_useState16[1];var _useState17=useState(\"\"),_useState18=_slicedToArray(_useState17,2),recRequirements=_useState18[0],setRecRequirements=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),uploading=_useState20[0],setUploading=_useState20[1];var dispatch=useDispatch();var gameDetails=useSelector(function(state){return state.gameDetails;});var loading=gameDetails.loading,error=gameDetails.error,game=gameDetails.game;var gameUpdate=useSelector(function(state){return state.gameUpdate;});var loadingUpdate=gameUpdate.loading,errorUpdate=gameUpdate.error,successUpdate=gameUpdate.success;var gameGenres=useSelector(function(state){return state.gameGenres;});var genres=gameGenres.genres;useEffect(function(){if(successUpdate){dispatch({type:GAME_UPDATE_RESET});dispatch({type:GAME_GENRE_RESET});history.push(\"/admin/gamelist\");}else{if(!game.title||game._id!==gameId){dispatch(getGameGenres());dispatch(listGameDetails(gameId));}else{setTitle(game.title);setPrice(game.price);setGenre(game.genre);setImage(game.image);setPublisher(game.publisher);setNumberInStock(game.numberInStock);setDescription(game.description);setMinRequirements(game.minRequirements);setRecRequirements(game.recRequirements);}}},[game,dispatch,gameId,history,successUpdate]);var uploadFileHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var file,formData,config,_yield$axios$post,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:file=e.target.files[0];formData=new FormData();formData.append(\"image\",file);setUploading(true);_context.prev=4;config={headers:{\"Content-Type\":\"multipart/form-data\"}};_context.next=8;return axios.post(\"/api/uploads\",formData,config);case 8:_yield$axios$post=_context.sent;data=_yield$axios$post.data;setImage(data);setUploading(false);_context.next=18;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](4);console.error(_context.t0);setUploading(false);case 18:case\"end\":return _context.stop();}}},_callee,null,[[4,14]]);}));return function uploadFileHandler(_x){return _ref2.apply(this,arguments);};}();var submitHandler=function submitHandler(e){e.preventDefault();dispatch(updateGame({_id:gameId,genre:genre||genre._id,title:title,price:price,publisher:publisher,image:image,numberInStock:numberInStock,description:description,minRequirements:minRequirements,recRequirements:recRequirements}));};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Meta,{title:\"Admin | Edit Game\"}),/*#__PURE__*/_jsx(Link,{to:\"/admin/gamelist\",className:\"btn btn-dark my-3\",children:\"Go Back\"}),/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsx(Row,{className:\"justify-content-center my-lg-3 my-md-3 my-4\",children:/*#__PURE__*/_jsx(Col,{lg:7,md:6,children:/*#__PURE__*/_jsxs(Card,{className:\"p-2\",bg:\"dark\",children:[/*#__PURE__*/_jsx(\"h1\",{style:{textAlign:\"center\"},children:\"Edit Game\"}),loadingUpdate&&/*#__PURE__*/_jsx(Loader,{}),errorUpdate&&/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:errorUpdate}),loading?/*#__PURE__*/_jsx(Loader,{}):error?/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:error}):/*#__PURE__*/_jsxs(Form,{onSubmit:submitHandler,children:[/*#__PURE__*/_jsxs(Row,{className:\"justify-content-center\",children:[/*#__PURE__*/_jsxs(Col,{className:\"text-right\",lg:5,children:[/*#__PURE__*/_jsxs(Form.Group,{controlId:\"title\",className:\"my-1\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Title:\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Title...\",value:title,onChange:function onChange(e){return setTitle(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"publisher\",className:\"my-1\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Publisher:\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Publisher...\",value:publisher,onChange:function onChange(e){return setPublisher(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"genre\",className:\"my-2\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Genre:\"}),/*#__PURE__*/_jsx(Form.Select,{onChange:function onChange(e){return setGenre(e.target.value);},children:genres.map(function(g){return/*#__PURE__*/_jsx(\"option\",{value:g._id,children:g.name},g._id);})})]})]}),/*#__PURE__*/_jsxs(Col,{className:\"text-center mx-2\",lg:5,children:[/*#__PURE__*/_jsxs(Form.Group,{controlId:\"price\",className:\"my-1\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Price:\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Price...\",value:price,onChange:function onChange(e){return setPrice(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"numberInStock\",className:\"my-1\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Stock:\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Stock...\",value:numberInStock,onChange:function onChange(e){return setNumberInStock(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"image\",className:\"my-1\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Image:\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Image...\",value:image,onChange:function onChange(e){return setImage(e.target.value);}}),/*#__PURE__*/_jsx(Form.Control,{type:\"file\",label:\"Choose File\",custom:\"true\",size:\"sm\",onChange:uploadFileHandler}),uploading&&/*#__PURE__*/_jsx(Loader,{})]})]})]}),/*#__PURE__*/_jsx(Row,{className:\"justify-content-center\",children:/*#__PURE__*/_jsxs(Col,{className:\"text-center\",lg:8,children:[/*#__PURE__*/_jsxs(Form.Group,{controlId:\"description\",className:\"my-1\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Description:\"}),/*#__PURE__*/_jsx(Form.Control,{as:\"textarea\",type:\"text\",placeholder:\"Description...\",value:description,onChange:function onChange(e){return setDescription(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"minRequiremens\",className:\"my-1\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Minimum Requirements: (Use \\\"_\\\" betwen component requirements)\"}),/*#__PURE__*/_jsx(Form.Control,{as:\"textarea\",type:\"text\",placeholder:\"Minimum Requirements...\",value:minRequirements,onChange:function onChange(e){return setMinRequirements(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"recRequiremens\",className:\"my-1\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Recommended Requirements: (Use \\\"_\\\" betwen component requirements)\"}),/*#__PURE__*/_jsx(Form.Control,{as:\"textarea\",type:\"text\",placeholder:\"Recommended Requirements...\",value:recRequirements,onChange:function onChange(e){return setRecRequirements(e.target.value);}})]}),/*#__PURE__*/_jsx(Form.Group,{style:{textAlign:\"center\"},children:/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"primary\",className:\"my-2\",children:\"Submit\"})})]})})]})]})})})})]});};export default GameEditScreen;","map":{"version":3,"sources":["C:/Users/Neboj≈°a/Desktop/Games_Dir/frontend/src/screens/GameEditScreen.jsx"],"names":["React","useState","useEffect","Link","Form","Button","Row","Col","Container","Card","useDispatch","useSelector","Message","Loader","getGameGenres","listGameDetails","updateGame","GAME_GENRE_RESET","GAME_UPDATE_RESET","axios","Meta","GameEditScreen","match","history","gameId","params","id","title","setTitle","price","setPrice","image","setImage","genre","setGenre","publisher","setPublisher","numberInStock","setNumberInStock","description","setDescription","minRequirements","setMinRequirements","recRequirements","setRecRequirements","uploading","setUploading","dispatch","gameDetails","state","loading","error","game","gameUpdate","loadingUpdate","errorUpdate","successUpdate","success","gameGenres","genres","type","push","_id","uploadFileHandler","e","file","target","files","formData","FormData","append","config","headers","post","data","console","submitHandler","preventDefault","textAlign","value","map","g","name"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { Form, Button, Row, Col, Container, Card } from \"react-bootstrap\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport Message from \"../components/Message\";\r\nimport Loader from \"../components/Loader\";\r\nimport {\r\n  getGameGenres,\r\n  listGameDetails,\r\n  updateGame,\r\n} from \"../actions/gameActions\";\r\nimport {\r\n  GAME_GENRE_RESET,\r\n  GAME_UPDATE_RESET,\r\n} from \"../constatns/gameConstatns\";\r\nimport axios from \"axios\";\r\nimport Meta from \"../components/Meta\";\r\n\r\nconst GameEditScreen = ({ match, history }) => {\r\n  const gameId = match.params.id;\r\n\r\n  const [title, setTitle] = useState(\"\");\r\n  const [price, setPrice] = useState(0);\r\n  const [image, setImage] = useState(\"\");\r\n  const [genre, setGenre] = useState(\"\");\r\n  const [publisher, setPublisher] = useState(\"\");\r\n  const [numberInStock, setNumberInStock] = useState(0);\r\n  const [description, setDescription] = useState(\"\");\r\n  const [minRequirements, setMinRequirements] = useState(\"\");\r\n  const [recRequirements, setRecRequirements] = useState(\"\");\r\n  const [uploading, setUploading] = useState(false);\r\n\r\n  const dispatch = useDispatch();\r\n\r\n  const gameDetails = useSelector((state) => state.gameDetails);\r\n  const { loading, error, game } = gameDetails;\r\n\r\n  const gameUpdate = useSelector((state) => state.gameUpdate);\r\n  const {\r\n    loading: loadingUpdate,\r\n    error: errorUpdate,\r\n    success: successUpdate,\r\n  } = gameUpdate;\r\n\r\n  const gameGenres = useSelector((state) => state.gameGenres);\r\n  const { genres } = gameGenres;\r\n\r\n  useEffect(() => {\r\n    if (successUpdate) {\r\n      dispatch({ type: GAME_UPDATE_RESET });\r\n      dispatch({ type: GAME_GENRE_RESET });\r\n      history.push(\"/admin/gamelist\");\r\n    } else {\r\n      if (!game.title || game._id !== gameId) {\r\n        dispatch(getGameGenres());\r\n        dispatch(listGameDetails(gameId));\r\n      } else {\r\n        setTitle(game.title);\r\n        setPrice(game.price);\r\n        setGenre(game.genre);\r\n        setImage(game.image);\r\n        setPublisher(game.publisher);\r\n        setNumberInStock(game.numberInStock);\r\n        setDescription(game.description);\r\n        setMinRequirements(game.minRequirements);\r\n        setRecRequirements(game.recRequirements);\r\n      }\r\n    }\r\n  }, [game, dispatch, gameId, history, successUpdate]);\r\n\r\n  const uploadFileHandler = async (e) => {\r\n    const file = e.target.files[0];\r\n    const formData = new FormData();\r\n    formData.append(\"image\", file);\r\n    setUploading(true);\r\n    try {\r\n      const config = {\r\n        headers: {\r\n          \"Content-Type\": \"multipart/form-data\",\r\n        },\r\n      };\r\n      const { data } = await axios.post(\"/api/uploads\", formData, config);\r\n      setImage(data);\r\n      setUploading(false);\r\n    } catch (error) {\r\n      console.error(error);\r\n      setUploading(false);\r\n    }\r\n  };\r\n\r\n  const submitHandler = (e) => {\r\n    e.preventDefault();\r\n    dispatch(\r\n      updateGame({\r\n        _id: gameId,\r\n        genre: genre || genre._id,\r\n        title,\r\n        price,\r\n        publisher,\r\n        image,\r\n        numberInStock,\r\n        description,\r\n        minRequirements,\r\n        recRequirements,\r\n      })\r\n    );\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Meta title=\"Admin | Edit Game\" />\r\n      <Link to=\"/admin/gamelist\" className=\"btn btn-dark my-3\">\r\n        Go Back\r\n      </Link>\r\n      <Container>\r\n        <Row className=\"justify-content-center my-lg-3 my-md-3 my-4\">\r\n          <Col lg={7} md={6}>\r\n            <Card className=\"p-2\" bg=\"dark\">\r\n              <h1 style={{ textAlign: \"center\" }}>Edit Game</h1>\r\n              {loadingUpdate && <Loader />}\r\n              {errorUpdate && <Message variant=\"danger\">{errorUpdate}</Message>}\r\n              {loading ? (\r\n                <Loader />\r\n              ) : error ? (\r\n                <Message variant=\"danger\">{error}</Message>\r\n              ) : (\r\n                <Form onSubmit={submitHandler}>\r\n                  <Row className=\"justify-content-center\">\r\n                    <Col className=\"text-right\" lg={5}>\r\n                      <Form.Group controlId=\"title\" className=\"my-1\">\r\n                        <Form.Label>Title:</Form.Label>\r\n                        <Form.Control\r\n                          type=\"text\"\r\n                          placeholder=\"Title...\"\r\n                          value={title}\r\n                          onChange={(e) => setTitle(e.target.value)}\r\n                        ></Form.Control>\r\n                      </Form.Group>\r\n                      <Form.Group controlId=\"publisher\" className=\"my-1\">\r\n                        <Form.Label>Publisher:</Form.Label>\r\n                        <Form.Control\r\n                          type=\"text\"\r\n                          placeholder=\"Publisher...\"\r\n                          value={publisher}\r\n                          onChange={(e) => setPublisher(e.target.value)}\r\n                        ></Form.Control>\r\n                      </Form.Group>\r\n                      <Form.Group controlId=\"genre\" className=\"my-2\">\r\n                        <Form.Label>Genre:</Form.Label>\r\n                        <Form.Select onChange={(e) => setGenre(e.target.value)}>\r\n                          {genres.map((g) => (\r\n                            <option key={g._id} value={g._id}>\r\n                              {g.name}\r\n                            </option>\r\n                          ))}\r\n                        </Form.Select>\r\n                      </Form.Group>\r\n                    </Col>\r\n                    <Col className=\"text-center mx-2\" lg={5}>\r\n                      <Form.Group controlId=\"price\" className=\"my-1\">\r\n                        <Form.Label>Price:</Form.Label>\r\n                        <Form.Control\r\n                          type=\"text\"\r\n                          placeholder=\"Price...\"\r\n                          value={price}\r\n                          onChange={(e) => setPrice(e.target.value)}\r\n                        ></Form.Control>\r\n                      </Form.Group>\r\n                      <Form.Group controlId=\"numberInStock\" className=\"my-1\">\r\n                        <Form.Label>Stock:</Form.Label>\r\n                        <Form.Control\r\n                          type=\"text\"\r\n                          placeholder=\"Stock...\"\r\n                          value={numberInStock}\r\n                          onChange={(e) => setNumberInStock(e.target.value)}\r\n                        ></Form.Control>\r\n                      </Form.Group>\r\n                      <Form.Group controlId=\"image\" className=\"my-1\">\r\n                        <Form.Label>Image:</Form.Label>\r\n                        <Form.Control\r\n                          type=\"text\"\r\n                          placeholder=\"Image...\"\r\n                          value={image}\r\n                          onChange={(e) => setImage(e.target.value)}\r\n                        ></Form.Control>\r\n                        <Form.Control\r\n                          type=\"file\"\r\n                          label=\"Choose File\"\r\n                          custom=\"true\"\r\n                          size=\"sm\"\r\n                          onChange={uploadFileHandler}\r\n                        ></Form.Control>\r\n                        {uploading && <Loader />}\r\n                      </Form.Group>\r\n                    </Col>\r\n                  </Row>\r\n                  <Row className=\"justify-content-center\">\r\n                    <Col className=\"text-center\" lg={8}>\r\n                      <Form.Group controlId=\"description\" className=\"my-1\">\r\n                        <Form.Label>Description:</Form.Label>\r\n                        <Form.Control\r\n                          as=\"textarea\"\r\n                          type=\"text\"\r\n                          placeholder=\"Description...\"\r\n                          value={description}\r\n                          onChange={(e) => setDescription(e.target.value)}\r\n                        ></Form.Control>\r\n                      </Form.Group>\r\n                      <Form.Group controlId=\"minRequiremens\" className=\"my-1\">\r\n                        <Form.Label>\r\n                          Minimum Requirements: (Use \"_\" betwen component\r\n                          requirements)\r\n                        </Form.Label>\r\n                        <Form.Control\r\n                          as=\"textarea\"\r\n                          type=\"text\"\r\n                          placeholder=\"Minimum Requirements...\"\r\n                          value={minRequirements}\r\n                          onChange={(e) => setMinRequirements(e.target.value)}\r\n                        ></Form.Control>\r\n                      </Form.Group>\r\n                      <Form.Group controlId=\"recRequiremens\" className=\"my-1\">\r\n                        <Form.Label>\r\n                          Recommended Requirements: (Use \"_\" betwen component\r\n                          requirements)\r\n                        </Form.Label>\r\n                        <Form.Control\r\n                          as=\"textarea\"\r\n                          type=\"text\"\r\n                          placeholder=\"Recommended Requirements...\"\r\n                          value={recRequirements}\r\n                          onChange={(e) => setRecRequirements(e.target.value)}\r\n                        ></Form.Control>\r\n                      </Form.Group>\r\n                      <Form.Group style={{ textAlign: \"center\" }}>\r\n                        <Button\r\n                          type=\"submit\"\r\n                          variant=\"primary\"\r\n                          className=\"my-2\"\r\n                        >\r\n                          Submit\r\n                        </Button>\r\n                      </Form.Group>\r\n                    </Col>\r\n                  </Row>\r\n                </Form>\r\n              )}\r\n            </Card>\r\n          </Col>\r\n        </Row>\r\n      </Container>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default GameEditScreen;\r\n"]},"metadata":{},"sourceType":"module"}